{"version":3,"sources":["uni-app:///main.js","webpack:////Users/lianhaiwei/Code/source/laboratory/Mini/mini-uni/pages/index/index.vue?4f11","webpack:////Users/lianhaiwei/Code/source/laboratory/Mini/mini-uni/pages/index/index.vue?d38c","webpack:////Users/lianhaiwei/Code/source/laboratory/Mini/mini-uni/pages/index/index.vue?c470","webpack:////Users/lianhaiwei/Code/source/laboratory/Mini/mini-uni/pages/index/index.vue?2824","uni-app:///pages/index/index.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;;;;;;;;;;;kDAAA;AACA;AACA,4F;AACAA,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;;;AAGpD;AACsN;AACtN,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAi2B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;ACgBr3B;AACA,MADA,kBACA;AACA;AACA,iBADA;AAEA,uBAFA;;AAIA,GANA;AAOA;AACA;AACA,eAFA,yBAEA;AACA;AACA,gBADA;AAEA;AACA;AACA;AACA;AACA,SANA;;AAQA,KAXA;AAYA;AACA,oBAbA,4BAaA,OAbA,EAaA;;AAEA;AACA,yBADA;AAEA,0BAFA;AAGA;AACA;AACA;AACA,SANA;;;AASA,KAxBA;AAyBA;AACA,iBA1BA,yBA0BA,GA1BA,EA0BA;AACA;AACA,6BADA;AAEA;AACA,oBADA,EAFA;;AAKA;AACA;AACA;AACA,SARA;;AAUA,KArCA;AAsCA;AACA,gBAvCA,wBAuCA,MAvCA,EAuCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BADA;AAEA;AACA;AACA,SAJA;;AAMA,KA/DA;AAgEA;AACA,mBAjEA,2BAiEA,EAjEA,EAiEA;AACA;AACA;AACA,6BADA;AAEA;AACA,qBADA,EAFA;;AAKA;AACA;AACA;AACA,SARA;;AAUA,KA7EA,EAPA,E","file":"pages/index/index.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=57280228&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=57280228&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"content\">\n    <button type=\"default\" @click=\"choosePhoto\">拍照或从相册选择一张照片</button>\n    <image :src=\"imgfile\" mode=\"widthFix\"></image>\n    <view v-if=\"searchResults\">\n      <view v-if=\"searchResults.matched\" style=\"width: 100%;text-align: center;\">{{searchResults.matched.typename}}</view>\n      <view v-else style=\"font-size: 14px;\">\n        <view v-for=\"(item, index) in searchResults.similars\" :key=\"index\" style=\"display: flex;\">\n          <view style=\"flex: 1;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;margin-right: 20px;\">{{item.keywords}}</view>\n          <view>{{item.typename}}</view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n<script>\n  export default {\n    data() {\n      return {\n        imgfile: '',\n        searchResults: []\n      }\n    },\n    methods: {\n      // 选取照片\n      choosePhoto() {\n        uni.chooseImage({\n          count: 1,\n          success: (res) => {\n            console.log(res)\n            this.imgfile = res.tempFilePaths[0]\n            this.readImage2Base64(this.imgfile)\n          }\n        })\n      },\n      // 由于图片转Base64的方法在跨端时API并不统一，所以我们需要根据条件编译，使用对应端的特定API来完成此功能。\n      readImage2Base64(imgfile) {\n        // #ifdef MP-WEIXIN\n        wx.getFileSystemManager().readFile({\n          filePath: imgfile,\n          encoding: 'base64',\n          success: (res) => {\n            console.log(res)\n            this.imageClassify(res.data)\n          }\n        })\n        // #endif\n      },\n      // 调用百度AI，图片识别，返回识别结果\n      imageClassify(b64) {\n        uniCloud.callFunction({\n          name: 'imageClassify',\n          data: {\n            image: b64\n          },\n          success: (res) => {\n            console.log(res)\n            this.parseResults(res.result.result)\n          }\n        })\n      },\n      // 处理识别结果\n      parseResults(result) {\n        let itemList = []\n        let abs_result_index\n        for(let i = 0; i < result.length; i++) {\n          let item = result[i]\n          if(item.score > .8) {\n            abs_result_index = i\n            break;\n          }\n          itemList.push(item.keyword + result.score)\n        }\n        \n        // 如果包含了最佳匹配，则不需要弹出选择\n        if(abs_result_index >= 0) {\n          this.selectRecResult(result[abs_result_index].keyword)\n          return\n        }\n        \n        uni.showActionSheet({\n          itemList: itemList,\n          success: (res) => {\n            this.selectRecResult(result[res.tapIndex].keyword)\n          }\n        })\n      },\n      // 查询垃圾分类结果\n      selectRecResult(kw) {\n        console.log(kw)\n        uniCloud.callFunction({\n          name: 'trashClassify',\n          data: {\n            keyword: kw\n          },\n          success: (res) => {\n            console.log(res)\n            this.searchResults = res.result\n          }\n        })\n      }\n    }\n  }\n</script>\n"],"sourceRoot":""}